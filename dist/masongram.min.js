!function(t,n,e){"use strict";t.masongram=e.fn.masongram=function(t){return this.each(function(){new o(this,t)})};var o=function(){function o(t,n){var e=this;l.forEach(function(t){e.require(t)}),d||(this.configure(n),this.setup(t))}var c,r,s,u,l=["jQuery","Masonry"],d=!1;return o.prototype={require:function(n){var e=void 0!==t[n];return e||(d=!0,console.error("Dependency unavailable: "+n)),e},configure:function(t){c=e.extend(!0,{endpoint:"users/self",loop:!1,count:10,offset:10,size:"low_resolution",caption:"{caption}"},t)},setup:function(o){var i=this;r=e("<div>").attr({class:"masongram-container"}).appendTo(o),e("<div>").attr({class:"masongram-image-sizer masongram-image-size-"+c.size}).appendTo(r),r.masonry({itemSelector:".masongram-image-container",columnWidth:".masongram-image-sizer",percentPosition:!0}),s=new a(c),s.on("loaded",function(t){i.append(t)});var u;e(t).scroll(function(){u||(u=setTimeout(function(){r.imagesLoaded().progress(function(){e(t).scrollTop()+e(t).height()>e(n).height()*(1-c.offset/100)&&i.load()}),u=null},100))}),r.on("layoutComplete",function(){r.imagesLoaded().progress(function(){e("body").height()<e(t).height()&&i.load()})}),i.load()},load:function(){u||(u=!0,s.load())},append:function(n){n.forEach(function(o,a){var s=new i(o,{caption:c.caption,size:c.size}),l=s.getObject();setTimeout(function(){l.imagesLoaded().progress(function(){r.append(l).masonry("appended",l),a+1===n.length&&(u=!1,e(t).trigger("scroll"))})},200*a)})}},o}(),a=function(){function t(t){n=t,o="https://api.instagram.com/v1/"+n.endpoint+"/media/recent/"}var n,o;return t.prototype={load:function(){if(o){var t=this,a=e.Deferred();return e.ajax({type:"POST",url:o,data:{access_token:n.access_token,count:n.count},dataType:"jsonp"}).success(function(i){e(t).trigger("loaded",[i.data]),a.resolve(i.data),n.loop||(o=!(!i.pagination||!i.pagination.next_url)&&i.pagination.next_url)}).error(function(){a.reject("Error fetching data")}),a.promise()}},on:function(t,n){e(this).on(t,function(t,e){n(e)})}},t}(),i=function(){function t(t,n){o=t,a=n,this.parseLocation(),this.create()}var n,o,a,i="NO_DATA";return t.prototype={create:function(){n=e("<a>").attr({tabindex:0,class:"masongram-image-container masongram-image-size-"+a.size});var t=e("<img>").attr({src:o.images[a.size].url,width:o.images[a.size].width,height:o.images[a.size].height,class:"masongram-image"});t.appendTo(n);var i=e("<div>",{class:"masongram-image-caption-container"}),c=e("<div>",{class:"masongram-image-caption"});o.caption&&o.caption.text&&c.html(this.parseCaption()),c.appendTo(i),i.appendTo(n)},getObject:function(){return n},parseLocation:function(){if(o.caption&&o.caption.text&&/@[\d]+\.[\d]+,[\d]+\.[\d]+/.test(o.caption.text)){var t=o.caption.text.match(/@([\d]+\.[\d]+),([\d]+\.[\d]+)/);o.caption.text=o.caption.text.replace(/\s*@([\d]+\.[\d]+),([\d]+\.[\d]+)/,""),o.location={latitude:t[1],longitude:t[2]}}},parseCaption:function(){var t=a.caption;if(/{.*}/.test(t)){var n=t.match(/{([^}]+)}/g);n.forEach(function(n){switch(n){case"{location}":t=t.replace(n,o.location&&void 0!==o.location.latitude&&void 0!==o.location.longitude?o.location.latitude+","+o.location.longitude:i);break;case"{latitude}":t=t.replace(n,o.location&&void 0!==o.location.latitude?o.location.latitude:i);break;case"{longitude}":t=t.replace(n,o.location&&void 0!==o.location.longitude?o.location.longitude:i);break;case"{caption}":t=t.replace(n,o.caption&&void 0!==o.caption.text?o.caption.text:i);break;case"{likes}":t=t.replace(n,o.likes&&void 0!==o.likes.count?o.likes.count:i);break;case"{link}":t=t.replace(n,o.link?o.link:i)}})}return t}},t}()}(window,document,jQuery);
//# sourceMappingURL=masongram.min.js.map
