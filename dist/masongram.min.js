!function(t,n,e){"use strict";t.masongram=$.fn.masongram=function(t){return this.each(function(){new o(this,t)})};var o=function(){function e(t,n){var e=this;u.forEach(function(t){e.require(t)}),l||(this.configure(n),this.setup(t))}var o,c,r,s,u=["jQuery","Masonry"],l=!1;return e.prototype={require:function(n){var e=void 0!==t[n];return e||(l=!0,console.error("Dependency unavailable: "+n)),e},configure:function(t){o=$.extend(!0,{endpoint:"users/self",loop:!1,count:10,offset:10,size:"low_resolution",caption:"{caption}"},t)},setup:function(e){var i=this;c=$("<div>").attr({class:"masongram-container"}).appendTo(e),$("<div>").attr({class:"masongram-image-sizer masongram-image-size-"+o.size}).appendTo(c),c.masonry({itemSelector:".masongram-image-container",columnWidth:".masongram-image-sizer",percentPosition:!0}),r=new a(o),r.on("loaded",function(t){i.append(t)});var s;$(t).scroll(function(){s||(s=setTimeout(function(){c.imagesLoaded().progress(function(){$(t).scrollTop()+$(t).height()>$(n).height()*(1-o.offset/100)&&i.load()}),s=null},100))}),c.on("layoutComplete",function(){c.imagesLoaded().progress(function(){$("body").height()<$(t).height()&&i.load()})}),i.load()},load:function(){s||(s=!0,r.load())},append:function(n){n.forEach(function(e,a){var r=new i(e,{caption:o.caption,size:o.size}),u=r.getObject();setTimeout(function(){u.imagesLoaded().progress(function(){c.append(u).masonry("appended",u),a+1===n.length&&(s=!1,$(t).trigger("scroll"))})},200*a)})}},e}(),a=function(){function t(t){n=t,e="https://api.instagram.com/v1/"+n.endpoint+"/media/recent/"}var n,e;return t.prototype={load:function(){if(e){var t=this,o=$.Deferred();return $.ajax({type:"POST",url:e,data:{access_token:n.access_token,count:n.count},dataType:"jsonp"}).success(function(a){$(t).trigger("loaded",[a.data]),o.resolve(a.data),n.loop||(e=!(!a.pagination||!a.pagination.next_url)&&a.pagination.next_url)}).error(function(){o.reject("Error fetching data")}),o.promise()}},on:function(t,n){$(this).on(t,function(t,e){n(e)})}},t}(),i=function(){function t(t,n){e=t,o=n,this.parseLocation(),this.create()}var n,e,o,a="NO_DATA";return t.prototype={create:function(){n=$("<a>").attr({tabindex:0,class:"masongram-image-container masongram-image-size-"+o.size});var t=$("<img>").attr({src:e.images[o.size].url,width:e.images[o.size].width,height:e.images[o.size].height,class:"masongram-image"});t.appendTo(n);var a=$("<div>",{class:"masongram-image-caption-container"}),i=$("<div>",{class:"masongram-image-caption"});e.caption&&e.caption.text&&i.html(this.parseCaption()),i.appendTo(a),a.appendTo(n)},getObject:function(){return n},parseLocation:function(){if(e.caption&&e.caption.text&&/@[\d]+\.[\d]+,[\d]+\.[\d]+/.test(e.caption.text)){var t=e.caption.text.match(/@([\d]+\.[\d]+),([\d]+\.[\d]+)/);e.caption.text=e.caption.text.replace(/\s*@([\d]+\.[\d]+),([\d]+\.[\d]+)/,""),e.location={latitude:t[1],longitude:t[2]}}},parseCaption:function(){var t=o.caption;if(/{.*}/.test(t)){var n=t.match(/{([^}]+)}/g);n.forEach(function(n){switch(n){case"{location}":t=t.replace(n,e.location&&void 0!==e.location.latitude&&void 0!==e.location.longitude?e.location.latitude+","+e.location.longitude:a);break;case"{latitude}":t=t.replace(n,e.location&&void 0!==e.location.latitude?e.location.latitude:a);break;case"{longitude}":t=t.replace(n,e.location&&void 0!==e.location.longitude?e.location.longitude:a);break;case"{caption}":t=t.replace(n,e.caption&&void 0!==e.caption.text?e.caption.text:a);break;case"{likes}":t=t.replace(n,e.likes&&void 0!==e.likes.count?e.likes.count:a);break;case"{link}":t=t.replace(n,e.link?e.link:a)}})}return t}},t}()}(window,document,$);
//# sourceMappingURL=masongram.min.js.map
